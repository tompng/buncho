<script src='src/shape.js'></script>
<script src='src/buncho.js'></script>
<script src='src/key.js'></script>
<script src='src/stage.js'></script>
<script src='src/enemy.js'></script>
<script>
const canvas = document.createElement('canvas')
onload = () => {
  const keymap = new KeyMap()
  keymap.attach(document)
  document.body.appendChild(canvas)
  canvas.width = canvas.height = 1024
  const ctx = canvas.getContext('2d')
  canvas.style.width = 512
  canvas.style.boxShadow='0 0 1px black'
  const b = new Buncho()
  const stage = new Stage()
  const enemies = [new Enemy(), new Enemy()]
  setInterval(()=>{
    ctx.save()
    ctx.clearRect(0, 0, 1024, 1024)
    ctx.translate(512, 800)
    ctx.scale(64, -64)
    b.update(keymap, stage)
    enemies.forEach(e => e.update(b.position))
    enemies.forEach(e => e.render(ctx))
    keymap.clear()
    stage.render(ctx)
    b.render(ctx)
    ctx.restore()
  }, 20)
}
</script>
